import{r as o,j as e,C as S,B as a,l as I,i as t,w as j,m,n as p,X as E,o as x,L as z,f as V,a1 as N,g as T,a5 as k,h as J,y as $}from"./mui-B3kyuV6P.js";import{u as B,a as w}from"./index-CTlqFO4F.js";import{b as F}from"./router-Dq9hdC_f.js";import{J as D,q as C,i as O,R as G}from"./mui-icons-Dh0F4x5g.js";import"./react--cgwBsGs.js";import"./api-xsH4HHeE.js";const Q=()=>{const{hackathonId:d}=F(),{user:M}=B(),[L,b]=o.useState(!0),[l,W]=o.useState([]),[y,u]=o.useState(""),[h,v]=o.useState(null),[f,c]=o.useState(""),[n,P]=o.useState(null);o.useEffect(()=>{d&&A()},[d]);const A=async()=>{try{b(!0);const i=(await w.getPendingJudgeRequests(parseInt(d))).data,r=i.find(g=>g.status==="APPROVED");P(r||null),W(i)}catch(s){console.error("Failed to fetch judge requests:",s),u("Failed to load judge requests. Please try again.")}finally{b(!1)}},R=async(s,i)=>{try{v(s),u(""),c("");const r=l.find(g=>g.user.id===s);await w.updateJudgeStatus({hackathonId:parseInt(d),userId:s,status:i}),i==="APPROVED"?(c(`✅ ${r?.user.username||"Judge"} has been approved as a judge! They can now evaluate submissions when judging phase begins.`),P(r||null)):c(`❌ ${r?.user.username||"Judge"} request has been rejected.`),await A(),setTimeout(()=>c(""),5e3)}catch(r){console.error("Failed to update judge status:",r),u(`Failed to ${i.toLowerCase()} judge request. Please try again.`)}finally{v(null)}};return L?e.jsx(S,{maxWidth:"md",sx:{mt:8,mb:4},children:e.jsxs(a,{sx:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"50vh"},children:[e.jsx(I,{size:40}),e.jsx(t,{variant:"h6",sx:{ml:2},children:"Loading judge requests..."})]})}):e.jsxs(S,{maxWidth:"md",sx:{mt:4,mb:6},children:[e.jsxs(a,{sx:{textAlign:"center",mb:4},children:[e.jsx(D,{sx:{fontSize:60,color:"primary.main",mb:2}}),e.jsx(t,{variant:"h3",component:"h1",gutterBottom:!0,sx:{fontWeight:"bold",color:"primary.main"},children:"Judge Management"}),e.jsx(t,{variant:"h6",color:"textSecondary",children:"Review and approve judge applications for this hackathon"})]}),y&&e.jsx(j,{severity:"error",sx:{mb:3},onClose:()=>u(""),children:y}),f&&e.jsx(j,{severity:"success",sx:{mb:3},onClose:()=>c(""),children:f}),n&&e.jsx(m,{elevation:2,sx:{mb:3,bgcolor:"success.50",border:"2px solid",borderColor:"success.main"},children:e.jsxs(p,{children:[e.jsxs(a,{sx:{display:"flex",alignItems:"center",mb:2},children:[e.jsx(C,{sx:{color:"success.main",mr:1}}),e.jsx(t,{variant:"h6",sx:{color:"success.main",fontWeight:"bold"},children:"Selected Judge"})]}),e.jsxs(a,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(E,{sx:{bgcolor:"success.main"},children:e.jsx(D,{})}),e.jsxs(a,{children:[e.jsx(t,{variant:"subtitle1",sx:{fontWeight:"bold"},children:n.user.username}),e.jsx(t,{variant:"body2",color:"text.secondary",children:n.user.email}),e.jsx(x,{label:"APPROVED",color:"success",size:"small",sx:{mt:.5}})]})]}),e.jsx(j,{severity:"info",sx:{mt:2},children:"This judge will be able to evaluate submissions once the judging phase begins."})]})}),e.jsx(m,{elevation:2,children:e.jsxs(p,{sx:{p:0},children:[e.jsxs(a,{sx:{p:3,pb:1},children:[e.jsx(t,{variant:"h5",sx:{fontWeight:"bold",mb:1},children:n?"Other Requests":"Pending Judge Requests"}),e.jsx(t,{variant:"body2",color:"textSecondary",children:n?`${l.filter(s=>s.status!=="APPROVED").length} other request(s) - judge already selected`:`${l.filter(s=>s.status==="PENDING").length} request(s) pending approval`})]}),l.filter(s=>s.status!=="APPROVED").length===0?e.jsxs(a,{sx:{p:4,textAlign:"center"},children:[e.jsx(O,{sx:{fontSize:48,color:"grey.400",mb:2}}),e.jsx(t,{variant:"h6",color:"textSecondary",children:n?"No other requests":"No pending judge requests"}),e.jsx(t,{variant:"body2",color:"textSecondary",children:n?"All other judge applications have been processed.":"All judge applications have been processed."})]}):e.jsx(z,{sx:{pt:0},children:l.filter(s=>s.status!=="APPROVED").map((s,i)=>e.jsxs("div",{children:[e.jsxs(V,{sx:{py:2},children:[e.jsx(N,{children:e.jsx(E,{sx:{bgcolor:"primary.main"},children:e.jsx(O,{})})}),e.jsx(T,{primary:e.jsxs(a,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(t,{variant:"subtitle1",sx:{fontWeight:"bold"},children:s.user.username||"Anonymous"}),e.jsx(x,{label:s.role,size:"small",color:"primary",variant:"outlined"}),e.jsx(x,{label:s.status,size:"small",color:s.status==="APPROVED"?"success":s.status==="REJECTED"?"error":"warning",variant:s.status==="PENDING"?"outlined":"filled"})]}),secondary:e.jsxs(a,{sx:{mt:.5},children:[e.jsx(t,{variant:"body2",color:"textSecondary",children:s.user.email}),s.createdAt&&e.jsxs(t,{variant:"caption",color:"textSecondary",children:["Applied: ",new Date(s.createdAt).toLocaleDateString()]})]})}),e.jsx(k,{children:s.status==="PENDING"?e.jsxs(a,{sx:{display:"flex",gap:1},children:[e.jsx(J,{variant:"contained",color:"success",size:"small",startIcon:e.jsx(C,{}),onClick:()=>R(s.user.id,"APPROVED"),disabled:h===s.user.id||!!n,sx:{minWidth:100},children:h===s.user.id?e.jsx(I,{size:16,color:"inherit"}):n?"Judge Selected":"Approve"}),e.jsx(J,{variant:"outlined",color:"error",size:"small",startIcon:e.jsx(G,{}),onClick:()=>R(s.user.id,"REJECTED"),disabled:h===s.user.id,sx:{minWidth:100},children:"Reject"})]}):e.jsx(x,{label:`${s.status}`,color:s.status==="APPROVED"?"success":"error",variant:"filled"})})]}),i<l.length-1&&e.jsx($,{})]},s.id))})]})}),e.jsx(m,{sx:{mt:3},elevation:1,children:e.jsxs(p,{children:[e.jsx(t,{variant:"h6",gutterBottom:!0,sx:{display:"flex",alignItems:"center"},children:"ℹ️ Judge Selection Guidelines"}),e.jsx(t,{variant:"body2",color:"textSecondary",component:"div",children:e.jsxs(a,{component:"ul",sx:{pl:2,m:0},children:[e.jsx("li",{children:"Review each judge application carefully"}),e.jsx("li",{children:e.jsx("strong",{children:"Once you approve a judge, they will be able to evaluate submissions during the judging phase"})}),e.jsx("li",{children:"Approved judges will receive email notification and scoring access"}),e.jsx("li",{children:"Rejected applications will be notified via email"}),e.jsx("li",{children:"You can change judge decisions if needed before the judging phase begins"}),n&&e.jsx("li",{style:{color:"#2e7d32",fontWeight:"bold"},children:"✅ Judge selected! They can now score submissions when judging begins."})]})})]})})]})};export{Q as default};
