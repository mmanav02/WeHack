import{r,j as e,C as v,B as a,l as w,i,m as T,n as U,h as f,x as V,y as $,G as h,v as S,F as N,z as O,Q,U as J}from"./mui-D_VXG_-A.js";import{u as K,s as X}from"./index-BoPtzRr-.js";import{b as Z,u as _}from"./router-BvxwVjPs.js";import{S as E,b as ee,c as te,F as se}from"./mui-icons-Bo5rYZLF.js";import"./react--cgwBsGs.js";import"./api-xsH4HHeE.js";const ce=()=>{const{hackathonId:n}=Z(),m=_(),{user:d}=K(),[o,P]=r.useState(!1),[B,W]=r.useState(!1),[k,l]=r.useState(""),[u,A]=r.useState(""),[p,D]=r.useState(""),[x,M]=r.useState(""),[c,G]=r.useState(null),[F,b]=r.useState(""),[I,g]=r.useState(""),[C,z]=r.useState(""),[y,j]=r.useState("");r.useEffect(()=>{d||m("/login",{state:{returnTo:`/hackathons/${n}/submit-project`}})},[d,n,m]);const H=()=>{let t=!0;return b(""),g(""),z(""),j(""),u.trim()?u.trim().length<3&&(b("Title must be at least 3 characters long"),t=!1):(b("Project title is required"),t=!1),p.trim()?p.trim().length<10&&(g("Description must be at least 10 characters long"),t=!1):(g("Project description is required"),t=!1),x.trim()&&!L(x.trim())&&(z("Please enter a valid URL (e.g., https://github.com/username/project)"),t=!1),c?c.size>50*1024*1024&&(j("File size must be less than 50MB"),t=!1):(j("Please upload a project file"),t=!1),t},L=t=>{try{const s=new URL(t);return s.protocol==="http:"||s.protocol==="https:"}catch{return!1}},R=t=>{const s=t.target.files?.[0];s&&(G(s),y&&j(""))},q=async t=>{if(t.preventDefault(),!d||!n){l("Missing user or hackathon information");return}if(!H()){l("Please fix the errors above");return}P(!0),l("");try{const s=new FormData;s.append("hackathonId",n),s.append("userId",d.id.toString()),s.append("title",u.trim()),s.append("description",p.trim()),s.append("projectUrl",x.trim()),s.append("file",c),console.log("🚀 Submitting project with data:"),console.log("- hackathonId:",n),console.log("- userId:",d.id),console.log("- title:",u.trim()),console.log("- description:",p.trim()),console.log("- projectUrl:",x.trim()),console.log("- file:",c?.name);const Y=await X.submitProject(s);console.log("✅ Project submitted successfully:",Y.data),W(!0),setTimeout(()=>{m(`/hackathons/${n}`)},3e3)}catch(s){console.error("❌ Project submission failed:",s),s.response?.data?.includes("60 seconds")?l("⏱️ Please wait 60 seconds before submitting again."):s.response?.data?.includes("File upload failed")?l("File upload failed. Please try with a smaller file."):s.response?.data?.includes("Team not found")?l("You need to join the hackathon first. Please register for the hackathon."):l(s.response?.data||s.message||"Failed to submit project. Please try again.")}finally{P(!1)}};return d?B?e.jsx(v,{maxWidth:"md",sx:{mt:8,mb:4},children:e.jsx(T,{elevation:3,children:e.jsxs(U,{sx:{p:4,textAlign:"center"},children:[e.jsx(E,{sx:{fontSize:60,color:"success.main",mb:2}}),e.jsx(i,{variant:"h4",color:"success.main",gutterBottom:!0,sx:{fontWeight:"bold"},children:"Project Submitted Successfully! 🎉"}),e.jsxs(i,{variant:"h6",sx:{mb:2},children:['Your project "',u,'" has been submitted to the hackathon!']}),e.jsx(i,{variant:"body1",sx:{mb:2},children:"Thank you for participating. Your submission will be evaluated by judges when the judging phase begins."}),e.jsx(i,{variant:"body2",color:"textSecondary",sx:{mb:3},children:"Redirecting to hackathon details in 3 seconds..."}),e.jsxs(a,{sx:{display:"flex",gap:2,justifyContent:"center"},children:[e.jsx(f,{variant:"contained",onClick:()=>m(`/hackathons/${n}`),children:"Back to Hackathon"}),e.jsx(f,{variant:"outlined",onClick:()=>m("/submissions"),children:"View All Submissions"})]})]})})}):e.jsxs(v,{maxWidth:"md",sx:{mt:4,mb:6},children:[e.jsxs(a,{sx:{textAlign:"center",mb:4},children:[e.jsx(ee,{sx:{fontSize:60,color:"primary.main",mb:2}}),e.jsx(i,{variant:"h3",component:"h1",gutterBottom:!0,sx:{fontWeight:"bold",color:"primary.main"},children:"Submit Your Project"}),e.jsx(i,{variant:"h6",color:"textSecondary",children:"Share your amazing creation with the hackathon community!"}),e.jsx(V,{sx:{maxWidth:200,mx:"auto",mt:2}})]}),k&&e.jsx($,{severity:"error",sx:{mb:3},children:k}),e.jsx(T,{elevation:2,children:e.jsxs(U,{sx:{p:4},children:[e.jsx(a,{component:"form",onSubmit:q,noValidate:!0,children:e.jsxs(h,{container:!0,spacing:3,children:[e.jsx(h,{item:!0,xs:12,children:e.jsx(S,{required:!0,fullWidth:!0,label:"Project Title",value:u,onChange:t=>A(t.target.value),error:!!F,helperText:F||"Give your project a catchy, descriptive name",placeholder:"e.g., AI-Powered Health Assistant",disabled:o})}),e.jsx(h,{item:!0,xs:12,children:e.jsx(S,{required:!0,fullWidth:!0,multiline:!0,rows:6,label:"Project Description",value:p,onChange:t=>D(t.target.value),error:!!I,helperText:I||"Describe what your project does, the problem it solves, and technologies used",placeholder:"Explain your project's purpose, features, technology stack, and impact...",disabled:o})}),e.jsx(h,{item:!0,xs:12,children:e.jsx(S,{fullWidth:!0,label:"Project URL (GitHub, Demo, etc.)",value:x,onChange:t=>M(t.target.value),error:!!C,helperText:C||"Optional: Link to your GitHub repo, live demo, or project website",placeholder:"https://github.com/username/project or https://myproject.com",disabled:o,InputProps:{startAdornment:e.jsx(te,{sx:{mr:1,color:"text.secondary"}})}})}),e.jsx(h,{item:!0,xs:12,children:e.jsxs(N,{fullWidth:!0,error:!!y,children:[e.jsx(O,{shrink:!0,htmlFor:"file-upload",children:"Project File Upload *"}),e.jsxs(a,{sx:{mt:2},children:[e.jsx(Q,{id:"file-upload",type:"file",onChange:R,disabled:o,inputProps:{accept:".zip,.rar,.tar.gz,.pdf,.doc,.docx,.txt,.md"},sx:{display:"none"}}),e.jsx("label",{htmlFor:"file-upload",children:e.jsx(f,{variant:"outlined",component:"span",startIcon:e.jsx(se,{}),disabled:o,sx:{mb:1},children:"Choose File"})}),c&&e.jsxs(i,{variant:"body2",sx:{mt:1,color:"success.main"},children:["✅ Selected: ",c.name," (",(c.size/1024/1024).toFixed(2)," MB)"]})]}),e.jsx(J,{children:y||"Upload your project files (source code, documentation, etc.) - Max 50MB"})]})}),e.jsx(h,{item:!0,xs:12,children:e.jsx(a,{sx:{textAlign:"center",mt:2},children:e.jsx(f,{type:"submit",variant:"contained",size:"large",disabled:o,startIcon:o?e.jsx(w,{size:20}):e.jsx(E,{}),sx:{px:6,py:1.5,fontSize:"1.1rem",fontWeight:"bold",borderRadius:3,background:"linear-gradient(45deg, #1976d2 30%, #42a5f5 90%)",transition:"all 0.3s ease-in-out","&:hover":{transform:"translateY(-2px)",boxShadow:"0 8px 25px rgba(25, 118, 210, 0.3)"},"&:disabled":{background:"grey.300",transform:"none"}},children:o?"Submitting Project...":"Submit Project"})})})]})}),e.jsxs(a,{sx:{mt:4,p:3,bgcolor:"grey.50",borderRadius:2},children:[e.jsx(i,{variant:"h6",gutterBottom:!0,sx:{display:"flex",alignItems:"center"},children:"📋 Submission Guidelines"}),e.jsx(i,{variant:"body2",color:"textSecondary",component:"div",children:e.jsxs(a,{component:"ul",sx:{pl:2,m:0},children:[e.jsx("li",{children:"Make sure your project title is descriptive and unique"}),e.jsx("li",{children:"Include technical details, challenges faced, and solutions in description"}),e.jsx("li",{children:"Provide GitHub repo or demo links if available"}),e.jsx("li",{children:"Upload source code, documentation, or project demos"}),e.jsx("li",{children:"Supported file formats: .zip, .rar, .tar.gz, .pdf, .doc, .docx, .txt, .md"}),e.jsx("li",{children:"Maximum file size: 50MB"})]})})]})]})})]}):e.jsx(v,{maxWidth:"md",sx:{mt:8,mb:4},children:e.jsxs(a,{sx:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"50vh"},children:[e.jsx(w,{size:40}),e.jsx(i,{variant:"h6",sx:{ml:2},children:"Checking authentication..."})]})})};export{ce as default};
