import{r,j as e,C as S,B as n,l as T,i,m as U,n as E,h as g,y as Y,w as $,G as h,v as P,F as N,z as O,U as J,V as K}from"./mui-6pu-mHHs.js";import{u as Q,s as X}from"./index-CeQrkf_Y.js";import{b as Z,u as _}from"./router-Btts6DUI.js";import{f as B,g as ee,h as te,F as se}from"./mui-icons-ByUxv65T.js";import"./react--cgwBsGs.js";import"./api-xsH4HHeE.js";const ce=()=>{const{hackathonId:l}=Z(),m=_(),{user:d}=Q(),[o,k]=r.useState(!1),[W,A]=r.useState(!1),[F,a]=r.useState(""),[u,D]=r.useState(""),[p,M]=r.useState(""),[x,G]=r.useState(""),[c,H]=r.useState(null),[I,b]=r.useState(""),[C,y]=r.useState(""),[w,z]=r.useState(""),[v,f]=r.useState("");r.useEffect(()=>{d||m("/login",{state:{returnTo:`/hackathons/${l}/submit-project`}})},[d,l,m]);const L=()=>{let t=!0;return b(""),y(""),z(""),f(""),u.trim()?u.trim().length<3&&(b("Title must be at least 3 characters long"),t=!1):(b("Project title is required"),t=!1),p.trim()?p.trim().length<10&&(y("Description must be at least 10 characters long"),t=!1):(y("Project description is required"),t=!1),x.trim()&&!R(x.trim())&&(z("Please enter a valid URL (e.g., https://github.com/username/project)"),t=!1),c?c.size>50*1024*1024&&(f("File size must be less than 50MB"),t=!1):(f("Please upload a project file"),t=!1),t},R=t=>{try{const s=new URL(t);return s.protocol==="http:"||s.protocol==="https:"}catch{return!1}},q=t=>{const s=t.target.files?.[0];s&&(H(s),v&&f(""))},V=async t=>{if(t.preventDefault(),!d||!l){a("Missing user or hackathon information");return}if(!L()){a("Please fix the errors above");return}k(!0),a("");try{const s=new FormData;s.append("hackathonId",l),s.append("userId",d.id.toString()),s.append("title",u.trim()),s.append("description",p.trim()),s.append("projectUrl",x.trim()),s.append("file",c),console.log("🚀 Submitting project with data:"),console.log("- hackathonId:",l),console.log("- userId:",d.id),console.log("- title:",u.trim()),console.log("- description:",p.trim()),console.log("- projectUrl:",x.trim()),console.log("- file:",c?.name);const j=await X.submitProject(s);console.log("✅ Project submitted successfully:",j.data),A(!0),setTimeout(()=>{m(`/hackathons/${l}`)},3e3)}catch(s){console.error("❌ Project submission failed:",s);const j=typeof s.response?.data=="string"?s.response.data:"";j.includes("60 seconds")?a("⏱️ Please wait 60 seconds before submitting again."):j.includes("File upload failed")?a("File upload failed. Please try with a smaller file."):j.includes("Team not found")?a("You need to join the hackathon first. Please register for the hackathon."):s.response?.status===500?a("Server error occurred. Please check the backend logs and try again."):a(s.response?.data?.message||s.message||"Failed to submit project. Please try again.")}finally{k(!1)}};return d?W?e.jsx(S,{maxWidth:"md",sx:{mt:8,mb:4},children:e.jsx(U,{elevation:3,children:e.jsxs(E,{sx:{p:4,textAlign:"center"},children:[e.jsx(B,{sx:{fontSize:60,color:"success.main",mb:2}}),e.jsx(i,{variant:"h4",color:"success.main",gutterBottom:!0,sx:{fontWeight:"bold"},children:"Project Submitted Successfully! 🎉"}),e.jsxs(i,{variant:"h6",sx:{mb:2},children:['Your project "',u,'" has been submitted to the hackathon!']}),e.jsx(i,{variant:"body1",sx:{mb:2},children:"Thank you for participating. Your submission will be evaluated by judges when the judging phase begins."}),e.jsx(i,{variant:"body2",color:"textSecondary",sx:{mb:3},children:"Redirecting to hackathon details in 3 seconds..."}),e.jsxs(n,{sx:{display:"flex",gap:2,justifyContent:"center"},children:[e.jsx(g,{variant:"contained",onClick:()=>m(`/hackathons/${l}`),children:"Back to Hackathon"}),e.jsx(g,{variant:"outlined",onClick:()=>m("/submissions"),children:"View All Submissions"})]})]})})}):e.jsxs(S,{maxWidth:"md",sx:{mt:4,mb:6},children:[e.jsxs(n,{sx:{textAlign:"center",mb:4},children:[e.jsx(ee,{sx:{fontSize:60,color:"primary.main",mb:2}}),e.jsx(i,{variant:"h3",component:"h1",gutterBottom:!0,sx:{fontWeight:"bold",color:"primary.main"},children:"Submit Your Project"}),e.jsx(i,{variant:"h6",color:"textSecondary",children:"Share your amazing creation with the hackathon community!"}),e.jsx(Y,{sx:{maxWidth:200,mx:"auto",mt:2}})]}),F&&e.jsx($,{severity:"error",sx:{mb:3},children:F}),e.jsx(U,{elevation:2,children:e.jsxs(E,{sx:{p:4},children:[e.jsx(n,{component:"form",onSubmit:V,noValidate:!0,children:e.jsxs(h,{container:!0,spacing:3,children:[e.jsx(h,{item:!0,xs:12,children:e.jsx(P,{required:!0,fullWidth:!0,label:"Project Title",value:u,onChange:t=>D(t.target.value),error:!!I,helperText:I||"Give your project a catchy, descriptive name",placeholder:"e.g., AI-Powered Health Assistant",disabled:o})}),e.jsx(h,{item:!0,xs:12,children:e.jsx(P,{required:!0,fullWidth:!0,multiline:!0,rows:6,label:"Project Description",value:p,onChange:t=>M(t.target.value),error:!!C,helperText:C||"Describe what your project does, the problem it solves, and technologies used",placeholder:"Explain your project's purpose, features, technology stack, and impact...",disabled:o})}),e.jsx(h,{item:!0,xs:12,children:e.jsx(P,{fullWidth:!0,label:"Project URL (GitHub, Demo, etc.)",value:x,onChange:t=>G(t.target.value),error:!!w,helperText:w||"Optional: Link to your GitHub repo, live demo, or project website",placeholder:"https://github.com/username/project or https://myproject.com",disabled:o,InputProps:{startAdornment:e.jsx(te,{sx:{mr:1,color:"text.secondary"}})}})}),e.jsx(h,{item:!0,xs:12,children:e.jsxs(N,{fullWidth:!0,error:!!v,children:[e.jsx(O,{shrink:!0,htmlFor:"file-upload",children:"Project File Upload *"}),e.jsxs(n,{sx:{mt:2},children:[e.jsx(J,{id:"file-upload",type:"file",onChange:q,disabled:o,inputProps:{accept:".zip,.rar,.tar.gz,.pdf,.doc,.docx,.txt,.md"},sx:{display:"none"}}),e.jsx("label",{htmlFor:"file-upload",children:e.jsx(g,{variant:"outlined",component:"span",startIcon:e.jsx(se,{}),disabled:o,sx:{mb:1},children:"Choose File"})}),c&&e.jsxs(i,{variant:"body2",sx:{mt:1,color:"success.main"},children:["✅ Selected: ",c.name," (",(c.size/1024/1024).toFixed(2)," MB)"]})]}),e.jsx(K,{children:v||"Upload your project files (source code, documentation, etc.) - Max 50MB"})]})}),e.jsx(h,{item:!0,xs:12,children:e.jsx(n,{sx:{textAlign:"center",mt:2},children:e.jsx(g,{type:"submit",variant:"contained",size:"large",disabled:o,startIcon:o?e.jsx(T,{size:20}):e.jsx(B,{}),sx:{px:6,py:1.5,fontSize:"1.1rem",fontWeight:"bold",borderRadius:3,background:"linear-gradient(45deg, #1976d2 30%, #42a5f5 90%)",transition:"all 0.3s ease-in-out","&:hover":{transform:"translateY(-2px)",boxShadow:"0 8px 25px rgba(25, 118, 210, 0.3)"},"&:disabled":{background:"grey.300",transform:"none"}},children:o?"Submitting Project...":"Submit Project"})})})]})}),e.jsxs(n,{sx:{mt:4,p:3,bgcolor:"grey.50",borderRadius:2},children:[e.jsx(i,{variant:"h6",gutterBottom:!0,sx:{display:"flex",alignItems:"center"},children:"📋 Submission Guidelines"}),e.jsx(i,{variant:"body2",color:"textSecondary",component:"div",children:e.jsxs(n,{component:"ul",sx:{pl:2,m:0},children:[e.jsx("li",{children:"Make sure your project title is descriptive and unique"}),e.jsx("li",{children:"Include technical details, challenges faced, and solutions in description"}),e.jsx("li",{children:"Provide GitHub repo or demo links if available"}),e.jsx("li",{children:"Upload source code, documentation, or project demos"}),e.jsx("li",{children:"Supported file formats: .zip, .rar, .tar.gz, .pdf, .doc, .docx, .txt, .md"}),e.jsx("li",{children:"Maximum file size: 50MB"})]})})]})]})})]}):e.jsx(S,{maxWidth:"md",sx:{mt:8,mb:4},children:e.jsxs(n,{sx:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"50vh"},children:[e.jsx(T,{size:40}),e.jsx(i,{variant:"h6",sx:{ml:2},children:"Checking authentication..."})]})})};export{ce as default};
